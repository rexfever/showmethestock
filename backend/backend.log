INFO:     Will watch for changes in these directories: ['/Users/rexsmac/workspace/stock-finder/backend']
INFO:     Uvicorn running on http://0.0.0.0:8010 (Press CTRL+C to quit)
INFO:     Started reloader process [74466] using WatchFiles
Process SpawnProcess-1:
Traceback (most recent call last):
  File "/Users/rexsmac/.pyenv/versions/3.8.0/lib/python3.8/multiprocessing/process.py", line 313, in _bootstrap
    self.run()
  File "/Users/rexsmac/.pyenv/versions/3.8.0/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/rexsmac/workspace/stock-finder/backend/venv/lib/python3.8/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
  File "/Users/rexsmac/workspace/stock-finder/backend/venv/lib/python3.8/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/Users/rexsmac/.pyenv/versions/3.8.0/lib/python3.8/asyncio/runners.py", line 43, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/Users/rexsmac/workspace/stock-finder/backend/venv/lib/python3.8/site-packages/uvicorn/server.py", line 68, in serve
    config.load()
  File "/Users/rexsmac/workspace/stock-finder/backend/venv/lib/python3.8/site-packages/uvicorn/config.py", line 467, in load
    self.loaded_app = import_from_string(self.app)
  File "/Users/rexsmac/workspace/stock-finder/backend/venv/lib/python3.8/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
  File "/Users/rexsmac/.pyenv/versions/3.8.0/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 783, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/Users/rexsmac/workspace/stock-finder/backend/main.py", line 53, in <module>
    allow_origins=get_cors_origins(),
  File "/Users/rexsmac/workspace/stock-finder/backend/main.py", line 40, in get_cors_origins
    if env_info.is_local:
AttributeError: 'dict' object has no attribute 'is_local'
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
INFO:     Started server process [78126]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'scheduler.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [78126]
INFO:     Started server process [78290]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:51632 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:51669 - "GET /latest-scan HTTP/1.1" 200 OK
INFO:     127.0.0.1:51697 - "GET /latest-scan HTTP/1.1" 200 OK
INFO:     127.0.0.1:51714 - "GET /available-scan-dates HTTP/1.1" 200 OK
INFO:     127.0.0.1:51716 - "OPTIONS /portfolio HTTP/1.1" 200 OK
INFO:     127.0.0.1:51714 - "GET /available-scan-dates HTTP/1.1" 200 OK
INFO:     127.0.0.1:51716 - "GET /portfolio HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:51718 - "OPTIONS /portfolio HTTP/1.1" 200 OK
INFO:     127.0.0.1:51716 - "GET /portfolio HTTP/1.1" 401 Unauthorized
WARNING:  WatchFiles detected changes in 'scheduler.py', 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [78290]
INFO:     Started server process [79274]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:51808 - "OPTIONS /auth/kakao/callback HTTP/1.1" 200 OK
카카오 콜백 요청: {'code': 'w1N4zsQGk0US_bqFxmiE9dyjsjBOgXT_nraN8lMc4JXIenhjFO9HjwAAAAQKDR-XAAABmXc7hEOxu3fh8M0xkQ', 'redirect_uri': 'http://localhost:3000/kakao-callback'}
카카오 토큰 응답 상태: 200
카카오 토큰 응답 내용: {"access_token":"0HZecjRQSn-32v_lMP1ceMuHvKurjFxpAAAAAQoXAc8AAAGZdzuOvbG7d-HwzTGR","token_type":"bearer","refresh_token":"Ij8pJG6mOZhP83Dci_8GfjlLDgbx1FStAAAAAgoXAc8AAAGZdzuOubG7d-HwzTGR","id_token":"eyJraWQiOiI5ZjI1MmRhZGQ1ZjIzM2Y5M2QyZmE1MjhkMTJmZWEiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiI0ZWI1NzllNTI3MDllYTY0ZThiOTQxYjljOTVkMjBkYSIsInN1YiI6IjQ0NTY1ODUwMjMiLCJhdXRoX3RpbWUiOjE3NTg2NDIwMTUsImlzcyI6Imh0dHBzOi8va2F1dGgua2FrYW8uY29tIiwibmlja25hbWUiOiLshpDsp4TtmJUiLCJleHAiOjE3NTg2NDkyMTUsImlhdCI6MTc1ODY0MjAxNSwicGljdHVyZSI6Imh0dHA6Ly9rLmtha2FvY2RuLm5ldC9kbi9jd0V1ZzcvYnRzSlBGckhMSUwvM0UydlBFYmM5QXpEWGVZMW92djlEMC9pbWdfMTEweDExMC5qcGciLCJlbWFpbCI6ImVtb3plcm9AbmF2ZXIuY29tIn0.juUs11eDXNvep0xnIPDoPZEyO6oKoSAyiScORKoS2LSCFJJCk1OaSIbBxx3Tdag8_nq-t1A63q9l-4HejKDnLHGPGQkQx75XIs9FJrX-3rXb-qX3ox1ON9PwqiRP8ran8COA7PliT3pVyIdmd4Xu9eiGFyouuXd2Rh1p-ynZpxmGdfivxyEjdIFA6Fbh8YuBxcxvukQx7GXminv_OnjJVKxZBKcP1WzYeH3tlx6fxt7mjm97jmXkkAkNKgSMh2uNwn-FQPr48RLCS5z1Gz4wQVx-1H3OeU-lYysp4f6KvEP_OeQKTfI6P2a9etQGsxt4njt5FNz_ly2hzJF29j4ZFg","expires_in":7199,"scope":"account_email profile_image profile_nickname","refresh_token_expires_in":5183999}
카카오 사용자 정보 응답 상태: 200
카카오 사용자 정보 응답 내용: {"id":4456585023,"connected_at":"2025-09-20T14:50:32Z","properties":{"nickname":"손진형","profile_image":"http://k.kakaocdn.net/dn/cwEug7/btsJPFrHLIL/3E2vPEbc9AzDXeY1ovv9D0/img_640x640.jpg","thumbnail_image":"http://k.kakaocdn.net/dn/cwEug7/btsJPFrHLIL/3E2vPEbc9AzDXeY1ovv9D0/img_110x110.jpg"},"kakao_account":{"profile_nickname_needs_agreement":false,"profile_image_needs_agreement":false,"profile":{"nickname":"손진형","thumbnail_image_url":"http://k.kakaocdn.net/dn/cwEug7/btsJPFrHLIL/3E2vPEbc9AzDXeY1ovv9D0/img_110x110.jpg","profile_image_url":"http://k.kakaocdn.net/dn/cwEug7/btsJPFrHLIL/3E2vPEbc9AzDXeY1ovv9D0/img_640x640.jpg","is_default_image":false,"is_default_nickname":false},"has_email":true,"email_needs_agreement":false,"is_email_valid":true,"is_email_verified":true,"email":"emozero@naver.com"}}
사용자 정보 구성: {'provider': 'kakao', 'provider_id': '4456585023', 'email': 'emozero@naver.com', 'name': '손진형', 'profile_image': 'http://k.kakaocdn.net/dn/cwEug7/btsJPFrHLIL/3E2vPEbc9AzDXeY1ovv9D0/img_640x640.jpg', 'phone_number': '', 'gender': '', 'age_range': '', 'birthday': ''}
사용자 생성 요청: email='emozero@naver.com' name='손진형' provider='kakao' provider_id='4456585023' birth_year=None kakao_account='' gender=None age_group=None birthday=None is_profile_complete=False membership_tier=<MembershipTier.FREE: 'free'> subscription_status=<SubscriptionStatus.ACTIVE: 'active'> subscription_expires_at=None payment_method=None is_admin=False is_active=True
INSERT 시도: email=emozero@naver.com, name=손진형, provider=kakao, provider_id=4456585023
IntegrityError 발생: UNIQUE constraint failed: users.email
get_user_by_provider 결과: email='emozero@naver.com' name='손진형' provider='kakao' provider_id='4456585023' birth_year=None kakao_account=None gender=None age_group=None birthday=None is_profile_complete=False membership_tier=<MembershipTier.PREMIUM: 'premium'> subscription_status=<SubscriptionStatus.ACTIVE: 'active'> subscription_expires_at=None payment_method=None is_admin=True is_active=True id=7 created_at=datetime.datetime(2025, 9, 20, 15, 21, 47) last_login=datetime.datetime(2025, 9, 22, 15, 20, 42)
사용자 생성 완료: email='emozero@naver.com' name='손진형' provider='kakao' provider_id='4456585023' birth_year=None kakao_account=None gender=None age_group=None birthday=None is_profile_complete=False membership_tier=<MembershipTier.PREMIUM: 'premium'> subscription_status=<SubscriptionStatus.ACTIVE: 'active'> subscription_expires_at=None payment_method=None is_admin=True is_active=True id=7 created_at=datetime.datetime(2025, 9, 20, 15, 21, 47) last_login=datetime.datetime(2025, 9, 22, 15, 20, 42)
마지막 로그인 시간 업데이트 완료
INFO:     127.0.0.1:51808 - "POST /auth/kakao/callback HTTP/1.1" 200 OK
INFO:     127.0.0.1:51823 - "GET /latest-scan HTTP/1.1" 200 OK
INFO:     127.0.0.1:51808 - "GET /available-scan-dates HTTP/1.1" 200 OK
INFO:     127.0.0.1:51825 - "GET /portfolio HTTP/1.1" 200 OK
INFO:     127.0.0.1:51827 - "GET /available-scan-dates HTTP/1.1" 200 OK
INFO:     127.0.0.1:51808 - "GET /portfolio HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'kakao.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [79274]
WARNING:  WatchFiles detected changes in 'kakao.py'. Reloading...
WARNING:  WatchFiles detected changes in 'kakao.py'. Reloading...
WARNING:  WatchFiles detected changes in 'kakao.py'. Reloading...
WARNING:  WatchFiles detected changes in 'kakao.py'. Reloading...
INFO:     Started server process [95381]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'scanner.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [95381]
WARNING:  WatchFiles detected changes in 'scanner.py', 'models.py'. Reloading...
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
WARNING:  WatchFiles detected changes in 'scheduler.py'. Reloading...
INFO:     Started server process [96197]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:56571 - "GET /latest-scan HTTP/1.1" 200 OK
INFO:     127.0.0.1:56577 - "GET /latest-scan HTTP/1.1" 200 OK
INFO:     127.0.0.1:56586 - "GET /latest-scan HTTP/1.1" 200 OK
INFO:     127.0.0.1:56589 - "GET /latest-scan HTTP/1.1" 200 OK
