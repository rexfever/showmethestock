# ìˆ˜ì •ë˜ì§€ ì•Šì€ YYYY-MM-DD í˜•ì‹ ì‚¬ìš© ë‚´ìš©

## ğŸ”´ ìˆ˜ì • í•„ìš” (ì•„ì§ ë¯¸ìˆ˜ì •)

### 1. `is_trading_day()` í•¨ìˆ˜ (ë¼ì¸ 307-311)
**í˜„ì¬ ìƒíƒœ**: YYYY-MM-DD í˜•ì‹ìœ¼ë¡œ íŒŒì‹±
```python
if len(check_date) == 8 and check_date.isdigit():  # YYYYMMDD í˜•ì‹
    date_str = f"{check_date[:4]}-{check_date[4:6]}-{check_date[6:8]}"  # YYYY-MM-DDë¡œ ë³€í™˜
    check_dt = datetime.strptime(date_str, '%Y-%m-%d').date()
elif len(check_date) == 10 and check_date.count('-') == 2:  # YYYY-MM-DD í˜•ì‹
    check_dt = datetime.strptime(check_date, '%Y-%m-%d').date()
```
**ë¬¸ì œì **: YYYYMMDD í˜•ì‹ ì…ë ¥ì„ YYYY-MM-DDë¡œ ë³€í™˜ í›„ íŒŒì‹± (ë¶ˆí•„ìš”í•œ ë³€í™˜)
**ìˆ˜ì • ë°©ì•ˆ**: ì§ì ‘ datetimeìœ¼ë¡œ íŒŒì‹±í•˜ê±°ë‚˜ YYYYMMDD í˜•ì‹ìœ¼ë¡œ íŒŒì‹±

### 2. `get_weekly_analysis()` í•¨ìˆ˜ (ë¼ì¸ 3116-3128)
**í˜„ì¬ ìƒíƒœ**: YYYY-MM-DD í˜•ì‹ìœ¼ë¡œ ë‚ ì§œ ìƒì„± í›„ BETWEEN ì¿¼ë¦¬ ì‚¬ìš©
```python
start_date = f"{year}-{month:02d}-{week_start:02d}"  # YYYY-MM-DD í˜•ì‹
end_date = f"{year}-{month:02d}-{week_end:02d}"      # YYYY-MM-DD í˜•ì‹

cursor.execute("""
    SELECT ... FROM scan_rank 
    WHERE date BETWEEN ? AND ?
    ORDER BY date
""", (start_date, end_date))
```
**ë¬¸ì œì **: DBì˜ date ì»¬ëŸ¼ì€ YYYYMMDD í˜•ì‹ì¸ë° YYYY-MM-DD í˜•ì‹ìœ¼ë¡œ BETWEEN ì¿¼ë¦¬ ìˆ˜í–‰
**ê²°ê³¼**: ì¿¼ë¦¬ê°€ ì‹¤íŒ¨í•˜ê±°ë‚˜ ë°ì´í„°ë¥¼ ì°¾ì§€ ëª»í•¨
**ìˆ˜ì • ë°©ì•ˆ**: YYYYMMDD í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ì¿¼ë¦¬

### 3. `validate_from_snapshot()` í•¨ìˆ˜ (ë¼ì¸ 761)
**í˜„ì¬ ìƒíƒœ**: JSON íŒŒì¼ ê²½ë¡œ ìƒì„± ì‹œ ì›ë³¸ `as_of` ì‚¬ìš©
```python
fname = f"scan-{as_of}.json"
```
**ë¬¸ì œì **: `as_of`ê°€ YYYY-MM-DD í˜•ì‹ì¼ ê²½ìš° JSON íŒŒì¼ëª…ë„ YYYY-MM-DD í˜•ì‹ì´ ë¨
**í˜„ì¬ ì½”ë“œ**: `compact_date`ë¡œ ë³€í™˜í•˜ì§€ë§Œ JSON íŒŒì¼ ê²½ë¡œì—ëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
**ìˆ˜ì • ë°©ì•ˆ**: `compact_date`ë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ ê²½ë¡œ ìƒì„±

---

## âš ï¸ ì˜ë„ì  ìœ ì§€ (ìˆ˜ì • ë¶ˆí•„ìš”)

### 1. ë©”ì¸íŠ¸ë„ŒìŠ¤ ì„¤ì • - ë‚ ì§œ ë²”ìœ„ íŒŒì‹± (ë¼ì¸ 2567-2568, 2572-2573)
**í˜„ì¬ ìƒíƒœ**: YYYY-MM-DD í˜•ì‹ìœ¼ë¡œ íŒŒì‹±
```python
start_dt = datetime.strptime(start_date, "%Y-%m-%d")
end_dt = datetime.strptime(end_date, "%Y-%m-%d")
```
**ì´ìœ **: í”„ë¡ íŠ¸ì—”ë“œì—ì„œ HTML input type="date"ë¡œ ì „ì†¡ë˜ë¯€ë¡œ YYYY-MM-DD í˜•ì‹ ìœ ì§€ í•„ìš”
**ìƒíƒœ**: âœ… ìœ ì§€ í•„ìš”

### 2. í”„ë¡ íŠ¸ì—”ë“œ ì½”ë“œ
**ìƒíƒœ**: âœ… ëª¨ë‘ ì˜ë„ì  ìœ ì§€
- HTML input type="date" í•„ë“œ (í‘œì¤€ í˜•ì‹)
- ë‚ ì§œ ë¡œì»¬ë¼ì´ì œì´ì…˜ í‘œì‹œ
- API í˜¸ì¶œ ì‹œ ì‚¬ìš©ì ì…ë ¥ í˜•ì‹

### 3. ë¡œê·¸ ë©”ì‹œì§€
**ìƒíƒœ**: âœ… ê°€ë…ì„±ì„ ìœ„í•œ í˜•ì‹ ìœ ì§€
```python
datetime.now().strftime('%Y-%m-%d %H:%M:%S')
```

---

## ğŸ“‹ ìˆ˜ì • ìš°ì„ ìˆœìœ„

### ğŸ”´ ì¦‰ì‹œ ìˆ˜ì • í•„ìš” (ë²„ê·¸)
1. **`get_weekly_analysis()`** - BETWEEN ì¿¼ë¦¬ê°€ ì‹¤íŒ¨í•¨
2. **`validate_from_snapshot()`** - JSON íŒŒì¼ ê²½ë¡œ ë¶ˆì¼ì¹˜ ê°€ëŠ¥

### ğŸŸ¡ ë‹¨ê¸° ìˆ˜ì • ê¶Œì¥ (ì„±ëŠ¥/ì¼ê´€ì„±)
3. **`is_trading_day()`** - ë¶ˆí•„ìš”í•œ í˜•ì‹ ë³€í™˜ ì œê±°

---

## ğŸ”§ ì˜ˆìƒ ìˆ˜ì • ì½”ë“œ

### 1. `is_trading_day()` ìˆ˜ì •
```python
if len(check_date) == 8 and check_date.isdigit():  # YYYYMMDD í˜•ì‹
    check_dt = datetime.strptime(check_date, '%Y%m%d').date()
elif len(check_date) == 10 and check_date.count('-') == 2:  # YYYY-MM-DD í˜•ì‹
    check_dt = datetime.strptime(check_date, '%Y-%m-%d').date()
```

### 2. `get_weekly_analysis()` ìˆ˜ì •
```python
start_date = f"{year}{month:02d}{week_start:02d}"  # YYYYMMDD í˜•ì‹
end_date = f"{year}{month:02d}{week_end:02d}"     # YYYYMMDD í˜•ì‹
```

### 3. `validate_from_snapshot()` ìˆ˜ì •
```python
fname = f"scan-{compact_date}.json"  # YYYYMMDD í˜•ì‹ ì‚¬ìš©
```



