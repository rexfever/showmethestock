# v3 추천 시스템 UX 구현 가이드

## 개요

v3 추천 시스템의 프론트엔드 UX는 백엔드 상태를 1:1로 번역하는 역할만 수행합니다.

## 핵심 원칙

1. **백엔드 상태를 정확히 번역만 수행**
   - 판단/해석 금지
   - 숫자, 점수, 엔진명, 추천 횟수 노출 금지
   - 중복 추천, 과거 상태 변경, 스캔 결과 노출 금지

2. **데이터 소스**
   - `recommendations` 테이블만 사용
   - `scan_results` 테이블은 절대 사용하지 않음

3. **렌더링 규칙**
   - ACTIVE: 메인 추천 영역
   - WEAK_WARNING: 메인 추천 영역 (ACTIVE와 동일 섹션)
   - BROKEN: 관리 필요 종목 섹션
   - ARCHIVED: 기본 화면 비노출 (히스토리에서만)
   - REPLACED: 절대 노출하지 않음

## 백엔드 상태 → UX 매핑

### ACTIVE
- **카드 헤더**: "추천 유효"
- **상태 요약**: "추천 당시 가정이 유지되고 있습니다"
- **행동 가이드**: "계획대로 관찰하거나 진입을 고려하세요"
- **보조 설명**: "현재 흐름은 추천 기준과 크게 달라지지 않았습니다"
- **색상**: 초록 계열
- **CTA**: 신규 진입 허용
- **제약**: ticker당 최대 1개만 렌더링

### WEAK_WARNING
- **카드 헤더**: "흐름 약화"
- **상태 요약**: "추천 당시 흐름이 약해지고 있습니다"
- **행동 가이드**: "변동성 확대에 유의하세요"
- **보조 설명**: "단기 움직임이 불안정해지고 있습니다"
- **색상**: 노랑/주황 계열
- **CTA**: 신규 진입 유지
- **특징**: 회복 시 ACTIVE로 복귀 가능

### BROKEN
- **카드 헤더**: "관리 필요"
- **상태 요약**: "추천 당시 가정이 깨졌습니다"
- **행동 가이드**: "리스크 관점에서 정리를 고려하세요"
- **보조 설명**: "현재 흐름은 추천 기준과 다르게 전개되고 있습니다"
- **색상**: 빨강/주황 계열
- **CTA**: 신규 진입 금지
- **섹션**: 추천 영역과 분리된 '관리 필요 종목' 섹션
- **특징**: BROKEN 상태는 복귀하지 않음

### ARCHIVED
- **카드 헤더**: "종료됨"
- **상태 요약**: "해당 추천은 종료되었습니다"
- **렌더링**: 기본 화면에 노출하지 않음, 히스토리/상세 화면에서만 접근 가능

### REPLACED
- **렌더링**: UX 노출 금지 (내부 상태로만 사용)
- **규칙**: 사용자는 항상 최신 추천만 보도록 처리

## 구현 파일

### 1. 상태 매핑 상수
- **파일**: `frontend/utils/v3StatusMapping.js`
- **내용**: 백엔드 상태 → UX 매핑 정의

### 2. 추천 카드 컴포넌트
- **파일**: `frontend/components/v3/RecommendationCardV3.js`
- **내용**: 상태별 카드 렌더링 (ACTIVE, WEAK_WARNING, BROKEN)

### 3. 스캐너 페이지
- **파일**: `frontend/pages/v3/scanner-v3.js`
- **내용**: 
  - API 호출 (`/api/v3/recommendations/active`, `/api/v3/recommendations/needs-attention`)
  - 상태별 섹션 분리
  - ticker당 ACTIVE 1개 보장

## API 엔드포인트

### ACTIVE 추천 조회
```
GET /api/v3/recommendations/active
```

### 관리 필요 추천 조회 (WEAK_WARNING, BROKEN)
```
GET /api/v3/recommendations/needs-attention
```

## 금지 사항

1. **숫자 노출 금지**
   - 추천 가격, 수익률, 손절 퍼센트 표시 금지

2. **중복 표현 금지**
   - "또 추천됨", "여러 번 추천" 같은 표현 금지

3. **스캔 결과 노출 금지**
   - `scan_results` 테이블을 UI에 사용하지 않음

4. **과거 상태 변경 금지**
   - 과거 카드의 상태가 현재 시세로 바뀌는 로직 금지

5. **해석/판단 금지**
   - 백엔드 상태를 그대로 번역만 수행

## 검증 체크리스트

- [ ] ACTIVE 추천은 메인 추천 영역에만 표시
- [ ] WEAK_WARNING은 ACTIVE와 동일 섹션에 표시
- [ ] BROKEN은 관리 필요 섹션에만 표시
- [ ] ARCHIVED는 기본 화면에 노출하지 않음
- [ ] REPLACED는 절대 노출하지 않음
- [ ] ticker당 ACTIVE는 최대 1개만 표시
- [ ] 숫자, 점수, 엔진명, 추천 횟수 노출하지 않음
- [ ] `scan_results` 테이블을 사용하지 않음
- [ ] `recommendations` 테이블만 사용

