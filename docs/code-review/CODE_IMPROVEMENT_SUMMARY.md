# ì½”ë“œ ê°œì„  ì™„ë£Œ ìš”ì•½

## âœ… ì™„ë£Œëœ ìˆ˜ì • ì‚¬í•­

### 1. ì—ëŸ¬ ì²˜ë¦¬ ì¶”ê°€ âœ…
- **ìœ„ì¹˜**: ëª¨ë“  `scan_with_preset` í˜¸ì¶œ
- **ìˆ˜ì • ë‚´ìš©**:
  - Fallback ë¹„í™œì„±í™” ì‹œ try-except ì¶”ê°€
  - Step 0, Step 1, Step 3ì— try-except ì¶”ê°€
  - `config.fallback_presets` ì¸ë±ìŠ¤ ì ‘ê·¼ ì‹œ ê²€ì¦ ì¶”ê°€
- **í…ŒìŠ¤íŠ¸**: âœ… í†µê³¼

### 2. target_min/target_max ê²€ì¦ âœ…
- **ìœ„ì¹˜**: Line 166-175
- **ìˆ˜ì • ë‚´ìš©**:
  - `target_min = max(1, config.fallback_target_min_*)` - ìµœì†Œ 1ê°œ ë³´ì¥
  - `target_max = max(target_min, config.fallback_target_max_*)` - ìµœì†Œ target_min ì´ìƒ ë³´ì¥
- **í…ŒìŠ¤íŠ¸**: âœ… í†µê³¼

### 3. ë³€ìˆ˜ëª… ê°œì„  âœ…
- **ìœ„ì¹˜**: ì „ì²´ í•¨ìˆ˜
- **ìˆ˜ì • ë‚´ìš©**:
  - `items` â†’ `step0_items`, `step1_items`, `step3_items`
  - `items_10_plus` â†’ `step0_items_10_plus`, `step1_items_10_plus`
  - `items_8_plus` â†’ `step1_items_8_plus`, `step3_items_8_plus`
  - `overrides` â†’ `step3_overrides`
- **íš¨ê³¼**: ë³€ìˆ˜ ìŠ¤ì½”í”„ ëª…í™•í™”, ê°€ë…ì„± í–¥ìƒ
- **í…ŒìŠ¤íŠ¸**: âœ… í†µê³¼

### 4. Step 3 for ë£¨í”„ ì œê±° âœ…
- **ìœ„ì¹˜**: Line 244-267
- **ìˆ˜ì • ë‚´ìš©**:
  - `for step_idx, overrides in enumerate(config.fallback_presets[2:3], start=3):` ì œê±°
  - ì§ì ‘ ì²˜ë¦¬ë¡œ ë³€ê²½: `step3_overrides = config.fallback_presets[2]`
- **íš¨ê³¼**: ê°€ë…ì„± í–¥ìƒ, ë¶ˆí•„ìš”í•œ ë£¨í”„ ì œê±°
- **í…ŒìŠ¤íŠ¸**: âœ… í†µê³¼

### 5. ì¼ê´€ì„± ê°œì„  âœ…
- **ìœ„ì¹˜**: Line 190, 197
- **ìˆ˜ì • ë‚´ìš©**:
  - Fallback ë¹„í™œì„±í™” ì‹œ `chosen_step = 0` ì„¤ì •
  - ì´ˆê¸°ê°’ `chosen_step = 0` â†’ `chosen_step = None`ìœ¼ë¡œ ë³€ê²½
- **íš¨ê³¼**: ì¼ê´€ì„± í–¥ìƒ
- **í…ŒìŠ¤íŠ¸**: âœ… í†µê³¼

## ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼

**ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼**: 9ê°œ í…ŒìŠ¤íŠ¸ ëª¨ë‘ ì„±ê³µ

1. âœ… test_step_0_success
2. âœ… test_step_1_success
3. âœ… test_step_2_success
4. âœ… test_step_3_success
5. âœ… test_all_steps_fail_returns_empty
6. âœ… test_step_4_not_executed
7. âœ… test_step_3_with_exact_target_min
8. âœ… test_step_3_with_below_target_min
9. âœ… test_step_3_with_zero_results

## ğŸ¯ ê°œì„  íš¨ê³¼

### ì½”ë“œ í’ˆì§ˆ
- âœ… ì—ëŸ¬ ì²˜ë¦¬ ê°•í™”: ì˜ˆì™¸ ìƒí™©ì— ëŒ€í•œ ì•ˆì „í•œ ì²˜ë¦¬
- âœ… ì…ë ¥ê°’ ê²€ì¦: target_min/target_max ìœ íš¨ì„± ë³´ì¥
- âœ… ê°€ë…ì„± í–¥ìƒ: ëª…í™•í•œ ë³€ìˆ˜ëª… ì‚¬ìš©
- âœ… ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ: ì½”ë“œ êµ¬ì¡° ê°œì„ 

### ê¸°ëŠ¥ ì•ˆì •ì„±
- âœ… Step 0~3ê¹Œì§€ë§Œ ì‚¬ìš© ë³´ì¥
- âœ… Step 7 ì œê±° í™•ì¸
- âœ… ë¹ˆ ë¦¬ìŠ¤íŠ¸ ë°˜í™˜ ë¡œì§ ì •ìƒ ì‘ë™
- âœ… ì—ëŸ¬ ë°œìƒ ì‹œ ì•ˆì „í•œ ì¢…ë£Œ

## ğŸ“ ë³€ê²½ëœ íŒŒì¼

- `backend/services/scan_service.py`: ëª¨ë“  ê°œì„  ì‚¬í•­ ì ìš©

## ğŸ” ë‹¤ìŒ ë‹¨ê³„ ê¶Œì¥ ì‚¬í•­

1. **í†µí•© í…ŒìŠ¤íŠ¸**: ì‹¤ì œ API ì—”ë“œí¬ì¸íŠ¸ì—ì„œ í…ŒìŠ¤íŠ¸
2. **ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§**: ìˆ˜ì • í›„ ì„±ëŠ¥ ë³€í™” ì¶”ì 
3. **ë¡œê¹… ê°œì„ **: ì—ëŸ¬ ë°œìƒ ì‹œ ë” ìƒì„¸í•œ ë¡œê·¸ ê¸°ë¡

